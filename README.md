When the user clicks on the Upload button, the program reads the file from the user’s desktop using the function module ALSM_EXCEL_TO_INTERNAL_TABLE. If the upload is successful, the system displays the message text “File uploaded successfully”. In case of failure, the function module FORMAT_MESSAGE is called to build the complete error message text with “File upload failed”. After successfully reading the file, the internal table data is looped through, and for each entry, the material master data is updated using the BAPI BAPI_MATERIAL_SAVEDATA by passing the required structures such as header data, client data, sales data, and material description. The BAPI return values are validated, and based on the response, either a commit or rollback is performed using BAPI_TRANSACTION_COMMIT for successful updates or BAPI_TRANSACTION_ROLLBACK in case of errors. The internal table is then modified with the corresponding status messages for each record processed. Finally, if the file is not initial, the processed file data along with the status messages is sent as an email attachment using the function module SO_NEW_DOCUMENT_ATT_SEND_API1 to ensure complete transparency of the update process.
